### üîç –ê–Ω–∞–ª–∏–∑ TLS-–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ —Å `tcpdump`

–ê–Ω–∞–ª–∏–∑ TLS-–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ —Å–ª–æ–∂–Ω–µ–µ, —Ç–∞–∫ –∫–∞–∫ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø–∞–∫–µ—Ç–æ–≤ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ. –û–¥–Ω–∞–∫–æ, –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –ø–æ–ª–µ–∑–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é:

---

## üìå –ß—Ç–æ –º–æ–∂–Ω–æ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤ TLS-—Ç—Ä–∞—Ñ–∏–∫–µ —Å `tcpdump`

1. **TLS-—Ä—É–∫–æ–ø–æ–∂–∞—Ç–∏–µ** (–∫–∞–∫–∏–µ —Å–µ—Ä–≤–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ, –∫–∞–∫–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è).
2. **–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã** (–º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å, –∫–∞–∫–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã —Å–µ—Ä–≤–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫–ª–∏–µ–Ω—Ç—É).
3. **–†–∞–∑–º–µ—Ä—ã –∏ —á–∞—Å—Ç–æ—Ç—É –ø–∞–∫–µ—Ç–æ–≤** (–º–æ–∂–µ—Ç –ø–æ–º–æ—á—å –≤ –≤—ã—è–≤–ª–µ–Ω–∏–∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ –∞—Ç–∞–∫–∞—Ö).
4. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—é –ø–æ –ø–æ—Ä—Ç—É TLS (443)** (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤—ã—è–≤–∏—Ç—å, –∫–∞–∫–∏–µ IP-–∞–¥—Ä–µ—Å–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç HTTPS).

---

## üìå –û—Å–Ω–æ–≤–Ω—ã–µ –∫–ª—é—á–∏ `tcpdump`

| –ö–ª—é—á | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| `-i <–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å>` | –£–∫–∞–∑—ã–≤–∞–µ—Ç —Å–µ—Ç–µ–≤–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `eth0`, `wlan0`) |
| `-n` | –û—Ç–∫–ª—é—á–∞–µ—Ç –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ IP-–∞–¥—Ä–µ—Å–æ–≤ –≤ –∏–º–µ–Ω–∞ —Ö–æ—Å—Ç–æ–≤ (—É—Å–∫–æ—Ä—è–µ—Ç —Ä–∞–±–æ—Ç—É) |
| `-X` | –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø–∞–∫–µ—Ç–æ–≤ –≤ ASCII –∏ HEX |
| `-A` | –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –ø–∞–∫–µ—Ç—ã –≤ ASCII (—É–¥–æ–±–Ω–æ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤) |
| `-c <—á–∏—Å–ª–æ>` | –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç —á–∏—Å–ª–æ –ø–∞–∫–µ—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –∑–∞—Ö–≤–∞—á–µ–Ω—ã |
| `-s <—Ä–∞–∑–º–µ—Ä>` | –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ä–∞–∑–º–µ—Ä –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ–º—ã—Ö –ø–∞–∫–µ—Ç–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 65535) |
| `-w <—Ñ–∞–π–ª>` | –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∑–∞—Ö–≤–∞—á–µ–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã –≤ —Ñ–∞–π–ª –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ |
| `-r <—Ñ–∞–π–ª>` | –ß–∏—Ç–∞–µ—Ç –ø–∞–∫–µ—Ç—ã –∏–∑ —Ñ–∞–π–ª–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ —Å `-w`) |

---

## üìå –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```sh
# 1. –ó–∞—Ö–≤–∞—Ç –ø–∞–∫–µ—Ç–æ–≤ —Ç–æ–ª—å–∫–æ —Å –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–≥–æ IP –§–∏–ª—å—Ç—Ä—É–µ—Ç —Ç—Ä–∞—Ñ–∏–∫, –æ—Ç–Ω–æ—Å—è—â–∏–π—Å—è –∫ `192.168.1.1`.
tcpdump -i eth0 host 192.168.1.1
# 2. –ê–Ω–∞–ª–∏–∑ HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –ø–æ—Ç–æ–∫–µ –í—ã–≤–æ–¥–∏—Ç HTTP-–∑–∞–ø—Ä–æ—Å—ã –≤ —á–∏—Ç–∞–µ–º–æ–º –≤–∏–¥–µ.
tcpdump -i eth0 -A port 80 or port 443 or port 993 or port 995 or port 465
# 3. –ó–∞–ø–∏—Å—å —Ç—Ä–∞—Ñ–∏–∫–∞ –∏ –ø–æ—Å–ª–µ–¥—É—é—â–∏–π –∞–Ω–∞–ª–∏–∑ –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤–µ—Å—å —Ç—Ä–∞—Ñ–∏–∫ –≤ —Ñ–∞–π–ª `capture.pcap`.
tcpdump -i eth0 -w capture.pcap
# 4. –ê–Ω–∞–ª–∏–∑ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ –û—Ç–∫—Ä—ã–≤–∞–µ—Ç —Ä–∞–Ω–µ–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã.
tcpdump -r capture.pcap
# 5. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ñ–ª–∞–≥–∞–º TCP SYN (—Ç–æ–ª—å–∫–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è)
tcpdump -i eth0 port 443 and 'tcp[tcpflags] & tcp-syn != 0'
```

## üîë –ú–æ–∂–Ω–æ –ª–∏ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å TLS-—Ç—Ä–∞—Ñ–∏–∫?

–ï—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á —Å–µ—Ä–≤–µ—Ä–∞, –º–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å —Ç—Ä–∞—Ñ–∏–∫ –≤ **Wireshark**.
–ù–æ –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **Perfect Forward Secrecy (PFS)** (–Ω–∞–ø—Ä–∏–º–µ—Ä, ECDHE), —Ç–æ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –±–µ–∑ –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–∞–º—è—Ç–∏ –∫–ª–∏–µ–Ω—Ç–∞ –∏–ª–∏ —Å–µ—Ä–≤–µ—Ä–∞.
