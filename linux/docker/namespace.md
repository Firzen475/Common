
**Namespace** — это виртуальное изолированное окружение, которое ограничивает видимость процессов, сетевых интерфейсов, пользователей и других ресурсов внутри контейнера.

| Тип                               | 	Изолируемый ресурс                               | 	Описание                                                                  |
|-----------------------------------|---------------------------------------------------|----------------------------------------------------------------------------|
| PID (Process ID)                  | 	Процессы                                         | 	Контейнер видит только свои процессы, а не все процессы хоста.            |
| NET (Network)                     | 	Сетевые интерфейсы, порты, маршруты              | 	Контейнер получает свою сетевую стеку (lo, eth0 и т. д.).                 |
| MNT (Mount)                       | 	Файловая система                                 | 	Контейнер имеет собственное дерево монтирования (/, /proc, /sys и т. д.). |
| UTS (Unix Time Sharing)           | 	Имя хоста и домена                               | 	Контейнер может иметь свой hostname, независимый от хоста.                |
| IPC (Inter-Process Communication) | 	Межпроцессное взаимодействие (очереди, семафоры) | 	Изолирует IPC, чтобы контейнеры не мешали друг другу.                     |
| USER (User)                       | 	UID/GID (идентификаторы пользователей)           | 	Позволяет мапить пользователей внутри контейнера в root на хосте.         |

## Принцип работы
* У каждого процесса обычно NS родителя. Поэтому процессы видят сеть монтирование и т.д.
* Текущий NS процесса отображается в `ls -al /proc/12345/ns/*`. Отображается:
  * `/proc/10/ns/cgroup -> 'cgroup:[4026531835]'` Цифра это inode
* Можно изменить NS процесса для одного из типов, изолировав его.
* Или добавить процесс в другой NS для отладки.
* Можно частично изолировать процесс по типу.
* **inode для одного процесса у хоста и контейнера разные.**

#### Команды
```shell
# Информация о NS процесса
lsns -p [pid]
# Запуск "песочницы" с отдельным hostname, сетью и процессами
unshare --pid --fork --mount-proc --net --uts [бинарник]
# Запустите новый процесс в том же Mount Namespace
unshare --mount=/proc/[pid другого процесса]/ns/mnt [бинарник]
# Подключение существующего процесса к другому NS (-m - Mount Namespace)
nsenter -m -t 12345 [бинарник]
# Полный цикл:
## Для процесса 1
unshare --mount bash
mount -t tmpfs none /tmp/my_mount
echo "Hello from A" > /tmp/my_mount/test.txt

## Для процесса 2
# Находим PID процесса A (например, 12345)
pgrep -f "unshare --mount bash"
# Подключаемся к его Mount Namespace
nsenter -m -t 12345 bash
# Проверяем
cat /tmp/my_mount/test.txt
```


