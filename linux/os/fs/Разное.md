# loop dev

Loop-устройство — это виртуальный блочный девайс в Linux, который позволяет монтировать обычные файлы как диски.

| Тип файла               | Можно писать? | Условия                                                                 |
|-------------------------|---------------|-------------------------------------------------------------------------|
| **Обычный файл** (`disk.img`) | ✅ Да         | Если отформатирован в ФС с поддержкой записи (`ext4`, `NTFS` и др.).    |
| **ISO-образ** (`iso9660`)    | ❌ Нет        | Только чтение. Для записи нужно пересоздавать образ или использовать OverlayFS. |
| **Шифрованный контейнер** (LUKS) | ✅ Да      | После открытия через `cryptsetup luksOpen`.                             |
| **SquashFS** (`.squashfs`)   | ❌ Нет        | Файловая система только для чтения.                                    |

```bash
dd if=/dev/zero of=disk.img bs=1M count=100  # Создаем файл 100 МБ
sudo losetup -fP disk.img # Автовыбор свободного /dev/loopX
losetup -a  # Список активных loop-устройств

sudo mkfs.ext4 /dev/loop0           # Создать ФС
sudo mount /dev/loop0 /mnt/loopdisk # Монтировать

sudo umount /mnt/loopdisk  # Размонтировать
sudo losetup -d /dev/loop0 # Отвязать loop
```